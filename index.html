<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<link rel="stylesheet" href="css/leaflet.css">
<link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
<link rel="stylesheet" href="css/L.Control.Locate.min.css">
<link rel="stylesheet" href="css/qgis2web.css">
<link rel="stylesheet" href="css/fontawesome-all.min.css">
<link rel="stylesheet" href="css/leaflet-measure.css">
<style>
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}
#map { 
    position: absolute; 
    top: 0; 
    bottom: 0; 
    left: 0; 
    right: 0; 
}
#sidebar {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 500;
    background: white;
    padding: 10px;
    border-radius: 5px;
    max-height: 90%;
    overflow-y: auto;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
}
#info {
    position: absolute;
    bottom: 10px;
    left: 10px;
    z-index: 500;
    background: white;
    padding: 10px;
    border-radius: 5px;
    width: 300px;
    max-height: 200px;
    overflow-y: auto;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
}
.layer-toggle {
    margin-bottom: 5px;
}
.toggle-button {
    display: none;
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 510;
    background: white;
    padding: 6px 10px;
    border-radius: 4px;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
    cursor: pointer;
}
@media (max-width: 768px) {
    #sidebar { display: none; }
    .toggle-button { display: block; }
}
</style>
<title>Leaflet Map with Sidebar</title>
</head>
<body>
<div id="map"></div>
<div class="toggle-button" onclick="toggleSidebar()">â˜° Layers</div>
<div id="sidebar">
    <div class="layer-toggle"><input type="checkbox" id="layer_Lwardboundary" checked> L Ward Boundary</div>
    <div class="layer-toggle"><input type="checkbox" id="layer_roads" checked> Roads</div>
    <div class="layer-toggle"><input type="checkbox" id="layer_buildings" checked> Buildings</div>
    <div class="layer-toggle"><input type="checkbox" id="layer_vegetation" checked> Vegetation</div>
    <div class="layer-toggle"><input type="checkbox" id="layer_coldhot1" checked> Cold/Hot Nagar</div>
    <div class="layer-toggle"><input type="checkbox" id="layer_coldhot2" checked> Cold/Hot Zones</div>
</div>
<div id="info">Click on a feature to see its attributes</div>

<script src="js/leaflet.js"></script>
<script src="js/L.Control.Locate.min.js"></script>
<script src="js/L.Control.Layers.Tree.min.js"></script>
<script src="js/Autolinker.min.js"></script>

<script src="data/Lwardboundary_1.js"></script>
<script src="data/roads_merged_3.js"></script>
<script src="data/building_140725_6.js"></script>
<script src="data/vegetation_7.js"></script>
<script src="data/cold_hot_neighbourhood_nagar_4.js"></script>
<script src="data/cold_hot_neighbourhood_5.js"></script>

<script>
var map = L.map('map', { zoomControl:false, maxZoom:28, minZoom:10 })
    .fitBounds([[19.1037,72.8798],[19.1193,72.9071]]);

var info = document.getElementById('info');

function onEachFeature(feature, layer) {
    layer.on({
        click: function(e) {
            let content = "<table>";
            for (const key in feature.properties) {
                content += "<tr><th>"+key+"</th><td>"+feature.properties[key]+"</td></tr>";
            }
            content += "</table>";
            info.innerHTML = content;
        }
    });
}

// --- Layers ---

var layer_Lwardboundary = L.geoJSON(Lwardboundary_1, {
    style: {color: "blue", weight: 2, fillOpacity: 0.1},
    onEachFeature: onEachFeature
}).addTo(map);

var layer_roads = L.geoJSON(roads_merged_3, {
    style: {color: "gray", weight: 1},
    onEachFeature: onEachFeature
}).addTo(map);

var layer_buildings = L.geoJSON(building_140725_6, {
    style: {color: "brown", weight: 1, fillOpacity: 0.7},
    onEachFeature: onEachFeature
}).addTo(map);

var layer_vegetation = L.geoJSON(vegetation_7, {
    style: {color: "green", weight: 1, fillOpacity: 0.5},
    onEachFeature: onEachFeature
}).addTo(map);

var layer_coldhot1 = L.geoJSON(cold_hot_neighbourhood_nagar_4, {
    style: function(feature) {
        return {
            color: "black",
            weight: 2,
            fillColor: feature.properties.type === "cold" ? "#00f" : "#f00",
            fillOpacity: 0.4
        };
    },
    onEachFeature: onEachFeature
}).addTo(map);

var layer_coldhot2 = L.geoJSON(cold_hot_neighbourhood_5, {
    style: function(feature) {
        return {
            color: "black",
            weight: 2,
            fillColor: feature.properties.type === "cold" ? "#00f" : "#f00",
            fillOpacity: 0.4
        };
    },
    onEachFeature: onEachFeature
}).addTo(map);

// --- Sidebar Toggle ---
function toggleSidebar() {
    var sidebar = document.getElementById('sidebar');
    if (sidebar.style.display === 'block' || sidebar.style.display === '') {
        sidebar.style.display = 'none';
    } else {
        sidebar.style.display = 'block';
    }
}

// --- Layer Checkboxes ---
function setupLayerToggle(id, layer) {
    document.getElementById(id).addEventListener('change', function() {
        if (this.checked) map.addLayer(layer); else map.removeLayer(layer);
    });
}

setupLayerToggle('layer_Lwardboundary', layer_Lwardboundary);
setupLayerToggle('layer_roads', layer_roads);
setupLayerToggle('layer_buildings', layer_buildings);
setupLayerToggle('layer_vegetation', layer_vegetation);
setupLayerToggle('layer_coldhot1', layer_coldhot1);
setupLayerToggle('layer_coldhot2', layer_coldhot2);

// --- Locate Control ---
L.control.locate({position: 'topleft'}).addTo(map);
</script>
</body>
</html>
