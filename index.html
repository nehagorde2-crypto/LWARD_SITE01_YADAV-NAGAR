<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Customized L Ward Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/leaflet.css">
<link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
<link rel="stylesheet" href="css/leaflet-measure.css">
<style>
  html, body, #map {
    width: 100%;
    height: 100%;
    margin: 0;
  }

  /* Sidebar styling */
  #sidebar {
    position: absolute;
    top: 0;
    left: 0;
    width: 270px;
    height: 100%;
    background: rgba(255,255,255,0.95);
    box-shadow: 2px 0 10px rgba(0,0,0,0.3);
    z-index: 1000;
    overflow-y: auto;
    padding: 10px 15px;
    transition: left 0.3s ease;
  }

  #sidebar.collapsed {
    left: -270px;
  }

  #toggleSidebar {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 1100;
    background: #333;
    color: white;
    border: none;
    padding: 6px 10px;
    border-radius: 5px;
    cursor: pointer;
  }

  #infoPanel {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 270px;
    background: rgba(255,255,255,0.95);
    padding: 10px;
    border-top: 1px solid #ccc;
    box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
    font-size: 13px;
  }

  #map {
    height: 100%;
    width: 100%;
  }

  .layer-item {
    margin: 6px 0;
  }
</style>
</head>

<body>
<button id="toggleSidebar">☰ Layers</button>

<div id="sidebar">
  <h3>Map Layers</h3>
  <div id="layerControls"></div>
  <div id="infoPanel"><b>Feature Info:</b><br><span id="featureInfo">Click a feature to view attributes.</span></div>
</div>

<div id="map"></div>

<!-- QGIS2WEB dependencies -->
<script src="js/qgis2web_expressions.js"></script>
<script src="js/leaflet.js"></script>
<script src="js/L.Control.Layers.Tree.min.js"></script>
<script src="js/L.Control.Locate.min.js"></script>
<script src="js/leaflet.rotatedMarker.js"></script>
<script src="js/leaflet.pattern.js"></script>
<script src="js/leaflet-hash.js"></script>
<script src="js/Autolinker.min.js"></script>
<script src="js/rbush.min.js"></script>
<script src="js/labelgun.min.js"></script>
<script src="js/labels.js"></script>
<script src="js/leaflet.photon.js"></script>
<script src="js/leaflet-measure.js"></script>

<!-- Your data -->
<script src="data/Lwardboundary_1.js"></script>
<script src="data/roads_merged_3.js"></script>
<script src="data/cold_hot_neighbourhood_nagar_4.js"></script>
<script src="data/cold_hot_neighbourhood_5.js"></script>
<script src="data/building_140725_6.js"></script>
<script src="data/vegetation_7.js"></script>

<script>
var map = L.map('map', {
  zoomControl: true,
  maxZoom: 22,
  minZoom: 10
}).setView([19.07, 72.88], 13);

// --- Base map ---
var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

// --- Layer styling ---
function style_Lwardboundary_1() {
  return { color: 'red', weight: 3, fillOpacity: 0 };
}

function style_roads_merged_3() {
  return { color: 'black', weight: 1.5 };
}

function style_building_140725_6() {
  return { color: '#666', fillColor: '#999', fillOpacity: 0.8, weight: 0.5 };
}

function style_vegetation_7() {
  return { color: 'green', fillColor: 'green', weight: 0, radius: 3, fillOpacity: 0.9 };
}

function style_cold_hot_neighbourhood_nagar_4() {
  return { color: 'black', weight: 3, fillOpacity: 0.2 };
}

function style_cold_hot_neighbourhood_5() {
  return { color: 'black', weight: 3, fillOpacity: 0.2 };
}

// --- GeoJSON Layers ---
var layer_Lwardboundary_1 = L.geoJson(json_Lwardboundary_1, { style: style_Lwardboundary_1 }).addTo(map);
var layer_roads_merged_3 = L.geoJson(json_roads_merged_3, { style: style_roads_merged_3 }).addTo(map);
var layer_cold_hot_neighbourhood_nagar_4 = L.geoJson(json_cold_hot_neighbourhood_nagar_4, { style: style_cold_hot_neighbourhood_nagar_4 }).addTo(map);
var layer_cold_hot_neighbourhood_5 = L.geoJson(json_cold_hot_neighbourhood_5, { style: style_cold_hot_neighbourhood_5 }).addTo(map);
var layer_building_140725_6 = L.geoJson(json_building_140725_6, { style: style_building_140725_6 }).addTo(map);
var layer_vegetation_7 = L.geoJson(json_vegetation_7, {
  pointToLayer: function (feature, latlng) {
    return L.circleMarker(latlng, style_vegetation_7());
  }
}).addTo(map);

// --- Sidebar Layer Control ---
var layers = {
  "L Ward Boundary": layer_Lwardboundary_1,
  "Roads": layer_roads_merged_3,
  "Cold/Hot Neighbourhood (Nagar)": layer_cold_hot_neighbourhood_nagar_4,
  "Cold/Hot Zones": layer_cold_hot_neighbourhood_5,
  "Buildings": layer_building_140725_6,
  "Vegetation": layer_vegetation_7
};

var layerControls = document.getElementById("layerControls");
for (const [name, layer] of Object.entries(layers)) {
  const div = document.createElement("div");
  div.classList.add("layer-item");
  const checkbox = document.createElement("input");
  checkbox.type = "checkbox";
  checkbox.checked = map.hasLayer(layer);
  checkbox.onchange = function() {
    if (this.checked) map.addLayer(layer);
    else map.removeLayer(layer);
  };
  div.appendChild(checkbox);
  const label = document.createElement("label");
  label.innerHTML = " " + name;
  div.appendChild(label);
  layerControls.appendChild(div);
}

// --- Feature Info on click ---
function onFeatureClick(e) {
  var props = e.target.feature.properties;
  var info = '';
  for (var key in props) {
    info += '<b>' + key + ':</b> ' + props[key] + '<br>';
  }
  document.getElementById('featureInfo').innerHTML = info;
}

for (const layer of Object.values(layers)) {
  layer.eachLayer(function(featureLayer) {
    featureLayer.on('click', onFeatureClick);
  });
}

// --- Sidebar toggle ---
document.getElementById("toggleSidebar").onclick = function() {
  document.getElementById("sidebar").classList.toggle("collapsed");
};
</script>
</body>
</html>
